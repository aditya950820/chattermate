(()=>{var w=(h,b,t)=>new Promise((m,p)=>{var g=a=>{try{s(t.next(a))}catch(e){p(e)}},f=a=>{try{s(t.throw(a))}catch(e){p(e)}},s=a=>a.done?m(a.value):Promise.resolve(a.value).then(g,f);s((t=t.apply(h,b)).next())});window.chattermateId;window.ChatterMate;(function(){function h(e){return/^#[0-9A-F]{6}$/i.test(e)}function b(){return"https://api.chattermate.chat/api/v1"}let t={baseUrl:b(),containerId:"chattermate-container",buttonId:"chattermate-button",chatBubbleColor:"#f34611",loadingContainerId:"chattermate-loading",tokenKey:"ctid",containerBottom:100,containerRight:20,containerWidth:400};function m(){let e=document.createElement("style");e.id="chattermate-styles",e.textContent=`
      #${t.buttonId} {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        border-radius: 30px;
        background: ${t.chatBubbleColor};
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        z-index: 999999;
        transition: transform 0.3s ease;
      }

      #${t.buttonId}:hover {
        transform: scale(1.1);
      }

      #${t.buttonId}.loading {
        position: relative;
      }

      #${t.buttonId}.loading:after {
        content: '';
        position: absolute;
        width: 16px;
        height: 16px;
        top: 50%;
        left: 50%;
        margin: -8px 0 0 -8px;
        border: 2px solid rgba(255,255,255,0.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: chattermate-spin 0.6s linear infinite;
      }

      #${t.buttonId}.active .chat-icon {
        display: none;
      }

      #${t.buttonId}.active .close-icon {
        display: block !important;
      }

      @keyframes chattermate-spin {
        to {transform: rotate(360deg);}
      }

      /* Subtle idle bounce for the chat button when closed */
      @keyframes chattermate-bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-3px); }
      }

      #${t.containerId} {
        position: fixed;
        bottom: ${t.containerBottom||100}px;
        right: ${t.containerRight||20}px;
        width: ${t.containerWidth||400}px;
        height: 600px;
        background: transparent;
        z-index: 999999;
        overflow: hidden;
        /* Animated open/close with slide + fade */
        opacity: 0;
        visibility: hidden;
        transform: translateY(16px) scale(0.98);
        transition: opacity 360ms cubic-bezier(0.22, 1, 0.36, 1), transform 360ms cubic-bezier(0.22, 1, 0.36, 1), visibility 0s linear 360ms;
        border: none;
        padding: 0;
        margin: 0;
        pointer-events: none;
      }

      #${t.containerId}.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
        transition: opacity 420ms cubic-bezier(0.22, 1, 0.36, 1), transform 420ms cubic-bezier(0.22, 1, 0.36, 1);
        pointer-events: auto;
      }

      /* Clean border around the widget container */
      #${t.containerId}::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 24px;
        pointer-events: none;
        border: 1px solid #e5e7eb;
      }

        .chattermate-iframe {
                width: 100%;
        height: 100%;
        border: none;
        padding: 0;
        margin: 0;
        display: block;
        border-radius: 24px;
        /* Rely on corner shadows from container */
        box-shadow: none;
      }

      #chattermate-mobile-close {
        display: none;
        position: fixed;
        top: 20px;
        right: 20px;
        width: 44px;
        height: 44px;
        background: transparent;
        border: none;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 1000000;
        transition: all 0.3s ease;
      }

      #chattermate-mobile-topbar {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        z-index: 999999;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        box-sizing: border-box;
      }

      #chattermate-mobile-topbar.active {
        display: flex;
      }

      #chattermate-mobile-topbar .topbar-title {
        font-size: 16px;
        font-weight: 600;
        color: #333;
        margin: 0;
      }

      #chattermate-mobile-close.active {
        display: flex;
      }

      @media (max-width: 768px) {
        #${t.containerId} {
          width: 100vw !important;
          height: 100vh !important;
          height: 100dvh !important; /* Dynamic viewport height for mobile browsers */
          top: 0 !important;
          left: 0 !important;
          bottom: 0 !important;
          right: 0 !important;
          border-radius: 0 !important;
          position: fixed !important;
          margin: 0 !important;
          padding: 0 !important;
        }

        #${t.containerId}.active {
          bottom: 0 !important;
        }

        .chattermate-iframe {
          border-radius: 0 !important;
          width: 100vw !important;
          height: 100vh !important;
          height: 100dvh !important; /* Dynamic viewport height for mobile browsers */
          position: absolute !important;
          top: 0 !important;
          left: 0 !important;
          margin: 0 !important;
          padding: 0 !important;
        }

        #${t.buttonId} {
          display: none;
        }

        #${t.buttonId}.mobile-closed {
          display: block !important;
        }

        #chattermate-mobile-close.active {
          display: flex !important;
        }

        #chattermate-mobile-close:hover {
          opacity: 0.7;
        }

        /* ASK_ANYTHING style specific mobile topbar */
        .ask-anything-mobile #chattermate-mobile-topbar.active {
          display: flex !important;
        }

        .ask-anything-mobile #chattermate-mobile-close.active {
          top: 15px !important;
          right: 15px !important;
          z-index: 1000001 !important;
        }

        /* When topbar is visible, push iframe down to avoid overlap */
        .ask-anything-mobile .chattermate-iframe {
          top: 60px !important;
          height: calc(100vh - 60px) !important;
          height: calc(100dvh - 60px) !important;
        }
      }

      @media (min-width: 769px) {
        #chattermate-mobile-close {
          display: none !important;
        }
      }
    `;let i=document.getElementById("chattermate-styles");i&&i.remove(),document.head.appendChild(e)}function p(){return localStorage.getItem(t.tokenKey)}function g(e){e&&localStorage.setItem(t.tokenKey,e)}function f(){localStorage.removeItem(t.tokenKey)}function s(){return window.innerWidth<=768}function a(){m();let e=document.createElement("div");e.id=t.buttonId,e.innerHTML=`
      <svg class="chat-icon" width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M45 15H15C13.3431 15 12 16.3431 12 18V42C12 43.6569 13.3431 45 15 45H25L30 52L35 45H45C46.6569 45 48 43.6569 48 42V18C48 16.3431 46.6569 15 45 15Z" fill="white"/>
        <path d="M36 27C36 27 32.5 26 30 26C27.5 26 24 27 24 31C24 35 27.5 36 30 36C32.5 36 36 35 36 35V33C36 33 33 34 31.5 34C30 34 27 33 27 31C27 29 30 28 31.5 28C33 28 36 29 36 29V27Z" fill="${t.chatBubbleColor}"/>
      </svg>
      <svg class="close-icon" width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <path d="M20 20L40 40M40 20L20 40" stroke="white" stroke-width="3" stroke-linecap="round"/>
      </svg>
    `;let i=document.createElement("div");i.id=t.containerId;let o=document.createElement("div");o.id="chattermate-mobile-close",o.innerHTML=`
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M5 12H19" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    `;let d=document.createElement("div");d.id="chattermate-mobile-topbar",d.innerHTML=`
      <h3 class="topbar-title">Chat</h3>
      <div style="width: 44px;"></div>
    `,document.body.appendChild(e),document.body.appendChild(i),document.body.appendChild(o),document.body.appendChild(d);let c=!1,n=null,u=!1;function y(){return w(this,null,function*(){if(!(u||n))try{u=!0,e.classList.add("loading");let l=p();n=document.createElement("iframe"),n.className="chattermate-iframe";let x=`${t.baseUrl}/widgets/${window.chattermateId}/data?widget_id=${window.chattermateId}`,C=l?{headers:{Authorization:`Bearer ${l}`}}:{};fetch(x,C).then(r=>r.text()).then(r=>{n.srcdoc=r,i.appendChild(n),e.classList.remove("loading"),n.style.opacity="1"}).catch(r=>{console.error("Failed to load widget:",r),e.classList.remove("loading")}),window.addEventListener("message",function(r){r.data.type==="TOKEN_UPDATE"&&(g(r.data.token),n.contentWindow.postMessage({type:"TOKEN_RECEIVED",token:r.data.token},"*"))})}catch(l){console.error("Failed to load widget:",l),e.classList.remove("loading")}finally{u=!1}})}y();function v(){c=!c,i.classList.toggle("active"),e.classList.toggle("active"),o.classList.toggle("active"),s()?c?(e.classList.remove("mobile-closed"),e.style.animation=""):(e.classList.add("mobile-closed"),e.style.animation="chattermate-bounce 2.2s ease-in-out infinite",d.classList.remove("active"),document.body.classList.remove("ask-anything-mobile")):c&&o.classList.remove("active"),c&&n&&n.contentWindow.postMessage({type:"SCROLL_TO_BOTTOM"},"*")}e.addEventListener("click",v),o.addEventListener("click",v),s()&&!c&&(e.classList.add("mobile-closed"),e.style.animation="chattermate-bounce 2.2s ease-in-out infinite"),window.addEventListener("resize",function(){let l=s();l&&!c?(e.classList.add("mobile-closed"),e.style.animation="chattermate-bounce 2.2s ease-in-out infinite",o.classList.remove("active")):l||(e.classList.remove("mobile-closed"),e.style.animation="",c&&o.classList.remove("active")),m()})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a(),window.addEventListener("message",function(e){if(e.data.type==="CUSTOMIZATION_UPDATE"){let i=e.data.data,o=i.chat_bubble_color;t.chatBubbleColor=h(o)?o:t.chatBubbleColor,s()?i.chat_style==="ASK_ANYTHING"&&isOpen?(document.body.classList.add("ask-anything-mobile"),mobileTopbar.classList.add("active")):(document.body.classList.remove("ask-anything-mobile"),mobileTopbar.classList.remove("active")):i.chat_style==="ASK_ANYTHING"?(t.containerBottom=90,t.containerRight=20,t.containerWidth=400):(t.containerBottom=100,t.containerRight=20,t.containerWidth=400),m();let d=document.querySelector(`#${t.buttonId} .chat-icon path:last-child`);d&&d.setAttribute("fill",t.chatBubbleColor)}}),window.ChatterMate={init:function(e){e.baseUrl&&(t.baseUrl=e.baseUrl),window.chattermateId=e.id}}})();})();
